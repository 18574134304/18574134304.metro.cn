(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ab0fd20"],{1959:function(e,t,a){e.exports=a.p+"img/send.5708999a.png"},"3ca4":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAaCAYAAABctMd+AAACs0lEQVRIS7WWS2hTQRSGe5PGJkGxIBgVKyQY8zKKLVRMRQ2o6Erd+VoIduFCUQRBBUFFEHfVnagbF7bZVF0UcaFxU9GF0BbyaiNBpCFdKCEKSWgeflNu5Dbm5k7AFobeO+c/3/xz5sxtlS6Dn3q9bkokEmeQnWUMMnoVRZlmftRisYy43e6yHkJpx85kMtZisfgazeFWOhZJViqVA8FgcKFlXA+uOh4nfsxgc7M2m22n0+ksNet0nVOKbSyQMiqbiJvN5hMej+eVNDwej99CfFcGjuaD3+8PS8NjsdhTanpeEv4T+LqVgncB/6fEujXv0PmKwr/jfIt0WTjQYcRPZGrO2Yz5fL5T0vBkMrmpVqvNS8KHgH+UhgshvX6dXr/fbgGTyRShx0/jvtYRHLDCAjdJuqezwPN8Pn8hFAoVO7r+WnE6ne4rl8vDuBxkQSsuZyjZi0Ag8Lndrpa1Iu23gau8m8QBq9X6zOVyfWskE7sDvNER5VwudzEcDldEnNgq8vay8DS1/9HIWYKnUqmjAB8QDGqcfKK99jTe6Z661iWf27V8bgsq/BG7uaTGpzBx1ev1RhWSDjE5wbA0bbGGaB+iSRWwFcCceMbEQUryTjyTv5Ffs4zVmvxFtPvFgU0iDrU8EEWZZ5ubRUz9ti8dHK634zomnsl/Q/6RFvkTwvmy7TaLcH8F9w/RHSf2Uo1HKNlJ7sIOyvmFue7mPJxnDOEk/Qa0BvgMz3/PBLc9omuY8+jsWgouciOA3gN8LF7ExalWq+PMRVqBxZysc6Fd5E/Z+lKpNEoZ+nnvYywA6P0fcMGYojy7stmsvVAo3GaRa3pgrfNfvGjbSC+HqtT77XZ7kv8I8oh62sGJzSncrhG2d9lA2AgL6FfGgJEe5g0lGo12OxyOc7wMGSXIxtnhW0o49gdyhDBmMu060wAAAABJRU5ErkJggg=="},"5d1d":function(e,t,a){"use strict";a("69e8")},"69e8":function(e,t,a){},"98ce":function(e,t,a){e.exports=a.p+"img/headPortrait.501c37e5.png"},a8d4:function(e,t,a){e.exports=a.p+"img/vehicleList.41d6dbfd.png"},b574:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{"background-color":"F9F9FB"}},[s("div",{staticClass:"vehicle"},[s("div",{staticClass:"vehicle-header"},[s("div",{staticClass:"vehicle_text"},[e._v("车辆列表")]),s("div",{staticClass:"vehicle_head"},[s("div"),s("div",[s("el-input",{staticClass:"vehicle_index",attrs:{size:"small",placeholder:"搜索","prefix-icon":"el-icon-search icons"},on:{input:e.searchBtn},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1)])]),this.vehicleData.data&&this.vehicleData.data.length?s("div",{staticClass:"vehicle_list"},e._l(this.vehicleData.data,(function(t,i){return s("div",{key:i,staticClass:"vehicle_list_item",on:{click:function(a){return e.dialSend(t)}}},[s("el-card",{staticClass:"vehicle_list_item_card"},[s("div",{staticClass:"vehicle_list_item_img"},[s("img",{attrs:{src:a("a8d4"),alt:"",srcset:""}})]),s("div",{staticClass:"vehicle_list_item_title"},[e._v(e._s(t.number))]),s("div",{staticClass:"vehicle_list_item_role"},[s("span",{staticClass:"item_role_img"},[s("img",{attrs:{src:a("3ca4"),alt:""}})]),s("span",{staticClass:"vehicle_list_item_role_text"},[e._v("角色：")]),s("span",{staticClass:"vehicle_list_item_role_text"},[e._v(e._s(t.device))])]),s("div",{staticClass:"vehicle_list_item_role"},[s("span",{staticClass:"item_role_img"},[s("img",{attrs:{src:a("cc4a"),alt:""}})]),s("span",{staticClass:"vehicle_list_item_role_text"},[e._v("车次：")]),s("span",{staticClass:"vehicle_list_item_role_text"},[e._v(e._s(t.bout_number))])])])],1)})),0):e._e(),s("div",{staticClass:"footer"},[s("div",{staticClass:"vehicle_Pagination"},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:this.vehicleData.total,size:"medium"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])]),s("div",{staticClass:"vehicleList_dialog"},[s("el-dialog",{staticClass:"dialog",attrs:{title:"邀请你视频通话",visible:e.dialogVisible,center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("div",{staticClass:"dialog_middle"},[s("img",{attrs:{src:a("98ce"),alt:""}})]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("div",{staticClass:"div_img"},[s("div",[s("img",{staticClass:"img_left",attrs:{src:a("f714"),alt:"",srcset:""}}),s("div",{staticClass:"img_text"},[e._v("接听")])]),s("div",[s("img",{staticClass:"img_right",attrs:{src:a("07b7"),alt:"",srcset:""}}),s("div",{staticClass:"img_text1"},[e._v("挂断")])])])])])],1),s("div",{staticClass:"vehicleList_dialog"},[s("el-dialog",{staticClass:"dialog1",attrs:{title:"添加账号",visible:e.addDialog,center:""},on:{"update:visible":function(t){e.addDialog=t}}},[s("div",{staticClass:"dialog_div"},[s("el-form",{ref:"ruleForm",staticClass:"dialog_ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"车辆名称",prop:"number"}},[s("div",{staticClass:"div_input"},[s("div"),s("div",{staticClass:"content_input"},[s("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.number,callback:function(t){e.$set(e.ruleForm,"number",t)},expression:"ruleForm.number"}})],1)])]),s("div",{staticClass:"dialog_div_line"}),s("el-form-item",{attrs:{label:"上传图片",prop:"name"}},[s("div",{staticClass:"vehicel_upload"},[s("div",{staticClass:"public-upload-image"},[s("el-upload",{ref:"upload_img",attrs:{action:"","list-type":"picture-card",multiple:"",limit:1,accept:".jpg, .jpeg, .png","on-preview":e.handlePictureCardPreview,"http-request":e.handleTestSuccess}},[s("i",{staticClass:"el-icon-plus"})])],1)])]),s("div",{staticClass:"dialog_div_line"})],1)],1),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("div",{staticClass:"dialog_div_button"},[s("el-button",{staticClass:"dialog_but",attrs:{type:"primary"},on:{click:e.submit}},[e._v("添加车辆")]),s("el-button",{staticClass:"dialog_but1",on:{click:function(t){e.addDialog=!1}}},[e._v("取消")])],1)])])],1),s("el-dialog",{staticClass:"dialog",attrs:{visible:e.sendFlag,fullscreen:!0,"show-close":!1,center:""},on:{"update:visible":function(t){e.sendFlag=t}}},[s("div",{staticClass:"dialogSend"},[s("img",{staticClass:"sendImg",attrs:{src:a("1959"),alt:""}}),s("div",{staticClass:"sendText"},[e._v("正在应急呼叫")])]),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.closeSend}},[e._v("取消呼叫")])],1)])],1)},i=[],n=a("1da1"),r=(a("96cf"),a("e9c4"),a("4de4"),a("d3b7"),a("b0c0"),a("e863")),l=a("ffdd"),o=a("2b0e"),c=null,d={data:function(){return{dialogVisible:!1,sendFlag:!1,addDialog:!1,keyword:"",ruleForm:{name:""},rules:{account:[{required:!0,message:"请输入车辆名称",trigger:"blur"}]},vehicleData:{},imgarr:[],userInfo:{},car_sn:""}},created:function(){this.$http.defaults.headers.common["token"]=JSON.parse(localStorage.getItem("user"))?JSON.parse(localStorage.getItem("user")).token:"",this.init()},mounted:function(){var e=this,t=sessionStorage.getItem("num")||1;this.userInfo=JSON.parse(localStorage.getItem("user"))?JSON.parse(localStorage.getItem("user")):{},console.log(this.client),this.client.queryPeersOnlineStatus(["3"]).then((function(e){console.log(e)})),this.client.on("MessageFromPeer",(function(t,a){e.getChannelMessage(t,a)})),1==t&&location.reload(),t++,sessionStorage.setItem("num",t)},methods:{getChannelMessage:function(e,t){var a=JSON.parse(e.text);console.log(a,"aaaaa"),3==a.messageId?(this.sendFlag=!1,this.$router.push({path:"emergency_video",query:{sn:this.car_sn}})):2==a.messageId&&(this.sendFlag=!1,this.$message.error("对方拒绝接听"))},closeSend:function(){var e=JSON.stringify({messageId:4});this.client.sendMessageToPeer({text:e},this.memberIdNum),this.sendFlag=!1},dialSend:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,i,n,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(r["a"])("Record/getChannel",{ground_id:t.userInfo&&t.userInfo.id,driver_id:e.id});case 2:if(s=a.sent,!s||200!=s.status){a.next=21;break}if(s.data.data.sn){a.next=7;break}return t.$message.error("房间号获取失败"),a.abrupt("return");case 7:t.car_sn=s.data.data.sn,localStorage.setItem("sn",s.data.data.sn),t.num++,i={name:e.driver,avatar:e.image},sessionStorage.setItem("sendRoleInfo",JSON.stringify(i)),n=JSON.stringify({avatar:e.image,id:e.id,messageId:1,name:t.userInfo.nickname,peerId:t.userInfo.id,role:"地面端",channelId:s.data.data.sn}),l="",l=e.id+"",t.memberIdNum=l,localStorage.setItem("memberId",l),t.client.sendMessageToPeer({text:n},l),t.sendFlag=!0,a.next=22;break;case 21:t.$message.error("sn获取失败请重试");case 22:case"end":return a.stop()}}),a)})))()},searchBtn:function(){var e=this;this.keyword?(clearTimeout(c),c=setTimeout((function(){e.init()}),800)):this.init()},init:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["w"])({keyword:e.keyword,line:""});case 2:a=t.sent,1==a.data.code&&(e.vehicleData=a.data.data);case 4:case"end":return t.stop()}}),t)})))()},onchangeSer:function(e){},handleSizeChange:function(e){console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){console.log("当前页: ".concat(e))},addVehicle:function(){this.addDialog=!0,this.ruleForm.number=""},handleTestSuccess:function(e){if(-1==e.file.type.indexOf("image"))return this.$message.error("请上传图片类型的文件"),void(this.$refs.upload_img.uploadFiles=this.$refs.upload_img.uploadFiles.filter((function(t){return e.file.name!=t.name})));this.imgarr=e},handlePictureCardPreview:function(e){console.log(e)},submit:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.ruleForm.number){t.next=2;break}return t.abrupt("return",e.$message({message:"请填写车辆名称",type:"warning"}));case 2:if(e.imgarr){t.next=4;break}return t.abrupt("return",e.$message({message:"请选择车辆照片",type:"warning"}));case 4:return t.next=6,Object(l["e"])({number:e.ruleForm.number,image:e.imgarr.file});case 6:a=t.sent,1==a.data.code?(e.addDialog=!1,e.$refs.upload_img.uploadFiles=e.$refs.upload_img.uploadFiles.filter((function(e){return file.file.name!=e.name}))):(e.$message.error(a.data.msg),e.$refs.upload_img.uploadFiles=e.$refs.upload_img.uploadFiles.filter((function(e){return file.file.name!=e.name})));case 8:case"end":return t.stop()}}),t)})))()}},beforeRouteEnter:function(e,t,a){if(o["default"].prototype.$rtc)return a({name:"video",query:{sn:o["default"].prototype.$rtc.channel}});a()}},u=d,g=(a("5d1d"),a("2877")),m=Object(g["a"])(u,s,i,!1,null,null,null);t["default"]=m.exports},cc4a:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAaCAYAAACtv5zzAAACDUlEQVRIS+2WPUsDQRCGb5MIV1iksDjQIqKSLwstBAsLU+Qf2EhSKFgoWigoWlhaGBRsBGOlolb+BIXYmS42yRkMXASLMwRMlSZfvnPkwhkvt0nIdS6E+5h39pmZnd0LEzAURRHL5fIBbiOMsUl61+9oNBo5+N4XCoWjUChUZYlEwiVJ0iMMi/1OauaHQJ9VVQ2zTCazDcHZICc3zLVDgBe8mLcJkGSyLCsojwcpXdfr9Y9OINhHYVtr2uPw+bLQTsAWhU/eCBj3+/35Tk4IxINJFbLDsSvtP4BbTq1E6KJvlNXdbV17XgMAGr049azVAU6n0+/1et8G0UXZbNZXq9VkLRgdgPscyvRpseEktKmvmQEFonbSQjcGm3amGQG2bGYzQBWZxImGSNZxcXHIlnozQCwQCNDRLaB8x7jscwCW+j8ARL0XDAZPadJ0Or2LbE6sADy9WQYqOoqOcBGdQKARTgZF6LdIA/15u7610WxZYUEoEeAWk0dtAtzQcU3HMH10pAFDili/OdbslmlcL/BbGBAkiXVZpZNBA+gD2Twgm6Xmc9XhcCxXKpUiD4rJyGfToAuj1Z/ouQVAS84gpZQuAugS7UobjTvgOwzfd0OZXwGYbQfQN5QWnEYJUU0hRW70huxXENSVnj0AQ78AqVTKLYoi/T/y4beB6O+4obcJ0JHXeBWBfwz+h2T+AbPPbD4CvgE7AAAAAElFTkSuQmCC"}}]);
//# sourceMappingURL=chunk-2ab0fd20.d174f2bd.js.map